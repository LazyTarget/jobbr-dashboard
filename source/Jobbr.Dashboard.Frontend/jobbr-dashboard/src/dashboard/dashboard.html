<template>
  <require from="./dashboard.scss"></require>
  <require from="./cpu-graph/cpu-graph"></require>
  <require from="./memory-graph/memory-graph"></require>
  <require from="../resources/elements/hightlightjs/highlightjs"></require>
  <require from="../resources/value-converters/timeSinceValueConverter"></require>
  <require from="../resources/value-converters/dateValueConverter"></require>
  <require from="../resources/value-converters/jobRunStateToColorValueConverter"></require>
  <require from="../resources/value-converters/fileSizeValueConverter"></require>

  <div class="dashboard">
    <div class="box box-no-title">
      <div class="box-content">
        <h2>
          <i class="fas fa-server"></i> Jobbr Server</h2>
        <ul class="flat-list">
          <li>
            <span class="icon">
              <i class="fas fa-link"></i>
            </span> http://
            <span class="text-highlight">localhost:1337</span>
          </li>
          <li>
            <span class="icon">
              <i class="fas fa-clock"></i>
            </span> Up for
            <strong class="text-success">2 hours 4 minutes</strong>
          </li>
          <li>
            <span class="icon">
              <i class="fas fa-fighter-jet"></i>
            </span>Max. concurrent Jobs:
            <span class="text-highlight">4</span>
          </li>
        </ul>
      </div>
    </div>
    <div class="box">
      <div class="box-title">
        <h1>
          <i class="fas fa-circle-notch ${jobRuns.length > 0 ? 'fa-spin' : ''} extra-spacing-right"></i>Scheduled &amp; Running Jobs
        </h1>
      </div>
      <div class="box-content">

        <p if.bind="jobRuns.length == 0">
          No scheduled / running jobs
        </p>

        <table if.bind="jobRuns.length > 0">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>State</th>
              <th>Progress</th>
              <th>Planned Start</th>
              <th>Actual Start</th>
              <th>Duration</th>
            </tr>
          </thead>
          <tbody>
            <tr repeat.for="run of jobRuns">
              <td>
                <a route-href="route: rundetail; params.bind: {id: run.jobRunId}">${run.jobRunId}</a>
              </td>
              <td>
                <strong>${run.jobName}</strong>
              </td>
              <td>
                <span class="${run.state | jobRunStateToColor}">${run.state}</span>
              </td>
              <td>${run.progress}
                <span if.bind="run.progress">%</span>
              </td>
              <td>${run.plannedStartUtc | date}</td>
              <td>${run.auctualStartUtc | timeSince:run.plannedStartUtc}
                <span if.bind="run.auctualStartUtc">later</span>
              </td>
              <td>${run.auctualEndUtc | timeSince:run.auctualStartUtc}</td>
            </tr>
          </tbody>
        </table>

        <button type="button" class="btn btn-primary">Primary</button>
        <button type="button" class="btn btn-secondary">Secondary</button>
        <button type="button" class="btn btn-success">Success</button>
        <button type="button" class="btn btn-danger">Danger</button>
        <button type="button" class="btn btn-warning">Warning</button>
        <button type="button" class="btn btn-info">Info</button>
        <button type="button" class="btn btn-light">Light</button>
        <button type="button" class="btn btn-dark">Dark</button>
        <br />
        <br />
        <div class="btn-group">
          <button type="button" class="btn btn-danger">Action</button>
          <button type="button" class="btn btn-danger dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="sr-only">Toggle Dropdown</span>
          </button>
          <div class="dropdown-menu">
            <a class="dropdown-item text-warning" href="#">
              <i class="fas fa-pause"></i> disable all triggers</a>
            <a class="dropdown-item" href="#">Another action</a>
            <a class="dropdown-item" href="#">Something else here</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Separated link</a>
          </div>
        </div>
      </div>
    </div>
    <div class="box">
      <div class="box-title">
        <h1>
          <i class="fas fa-microchip extra-spacing-right"></i>CPU / Memory</h1>
      </div>
      <div class="box-content">
        <!-- <cpu-graph></cpu-graph>
        <memory-graph></memory-graph> -->
      </div>
    </div>
    <div class="box">
      <div class="box-title">
        <h1>
          <i class="fas fa-hdd extra-spacing-right"></i>Storage</h1>
      </div>
      <div class="box-content">

        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Free Space</th>
              <th>Total Space</th>
            </tr>
          </thead>
          <tbody>
            <tr repeat.for="disk of disks">
              <td>${disk.name}</td>
              <td class="text-success">${disk.freeSpace | fileSize}</td>
              <td>${disk.totalSpace | fileSize}</td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>
  </div>
</template>
